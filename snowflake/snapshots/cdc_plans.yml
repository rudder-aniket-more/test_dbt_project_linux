snapshots:
  - name: cdc_plans
    relation: source('IDEON_RAW', 'PLANS')
    config:
      schema: Bronze
      database: '{{target.database}}'  
      unique_key: id || '_' || year
      strategy: check
      check_cols: ['carrier_name','display_name','effective_date','expiration_date','name','plan_type','service_area_id','source','type','adult_dental','age29_rider','ambulance','benefits_summary_url','buy_link','child_dental','child_eyewear','child_eye_exam','customer_service_phone_number','durable_medical_equipment','diagnostic_test','dp_rider','drug_formulary_url','emergency_room','family_drug_deductible','family_drug_moop','family_medical_deductible','family_medical_moop','fp_rider','generic_drugs','habilitation_services','hios_issuer_id','home_health_care','hospice_service','hsa_eligible','id','imaging','individual_drug_deductible','individual_drug_moop','individual_medical_deductible','individual_medical_moop','inpatient_birth','inpatient_facility','inpatient_mental_health','inpatient_physician','inpatient_substance','level','logo_url','non_preferred_brand_drugs','on_market','off_market','out_of_network_coverage','outpatient_facility','outpatient_mental_health','outpatient_physician','outpatient_substance','plan_market','preferred_brand_drugs','prenatal_postnatal_care','preventative_care','primary_care_physician','rehabilitation_services','skilled_nursing','specialist','specialty_drugs','urgent_care','actuarial_value','chiropractic_services','coinsurance','embedded_deductible','gated','imaging_center','imaging_physician','lab_test','mail_order_rx','nonpreferred_generic_drug_share','nonpreferred_specialty_drug_share','outpatient_ambulatory_care_center','plan_calendar','prenatal_care','postnatal_care','skilled_nursing_facility_365','essential_health_benefits_percentage','covered_ages','formulary_name','issuer_plan_code','key_benefits_complete','sbc_name','actively_marketed','network_size','premium','premium_subsidized','package_codes','network_name','plan_coinsurance','inpatient_birth_physician','infertility_treatment_rider','abortion_rider','telemedicine','plan_ancestors','carrier_disclaimers','estimated_actuarial_value','summary_of_benefits_url','network_provider_directory_url','cms_quality_ratings_overall','cms_quality_ratings_medical_care','cms_quality_ratings_member_experience','cms_quality_ratings_plan_administration','carrier_brand_id','standardized_plan','STATE','YEAR']
      dbt_valid_to_current: "to_date('9999-12-31')" # Specifies that current records should have `dbt_valid_to` set to `'9999-12-31'` instead of `NULL`.