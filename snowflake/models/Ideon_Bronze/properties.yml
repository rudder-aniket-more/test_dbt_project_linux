version: 2

models:
  - name : CDC_PLANS
    config:
      materialized: table
    description : SCD 2 Table for plans
    columns:
      - name : id
        data_tests :
          - not_null
          - unique
      - name : state
        data_tests :
          - not_null
          - unique
      - name : gross_amount
        data_tests :
          - not_null
          - generic_non_negative
      - name : plan_type
        data_tests :
          - not_null
          - accepted_values :
              arguments :
                values : [HMO,PPO,EPO,POS]
  
  - name: dim_store
    config:
      materialized: table
      schema: bronze
    columns:
      - name: store_sk
        data_tests:
          - not_null
          - unique
      - name: country
        data_tests:
          - not_null
          - accepted_values:
              arguments :
                values : ['USA1', 'Canada']
              config:
                severity: warn